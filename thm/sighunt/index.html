<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="robots" content="noindex">

  <title>Writeup TryHackme Sighunt</title>

  <meta name="description" content="Tryhackme Sighunt Room Writeup By Md Amiruddin">
  <meta name="author" content="Md Amiruddin">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Writeup TryHackme Sighunt">
  <meta name="twitter:description" content="Tryhackme Sighunt Room Writeup By Md Amiruddin">
  <meta name="twitter:creator" content="Md Amiruddin">  
  <meta name="twitter:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/d4a19b63d083873e115f15b642c52981.png" />

  <meta property="og:site_name" content="Md Amiruddin" />
  <meta property="og:type" content="article">
  <meta property="og:title" content="Writeup TryHackme Sighunt">
  <meta property="og:description" content="Tryhackme Sighunt Room Writeup By Md Amiruddin">
  <meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/d4a19b63d083873e115f15b642c52981.png" />

  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" type="image/png" sizes="64x64" href="https://tryhackme-images.s3.amazonaws.com/room-icons/d4a19b63d083873e115f15b642c52981.png">

  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">
  
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css?1678854914750547280">
  <link rel="canonical" href="http://localhost:4000/">
  <link rel="alternate" type="application/rss+xml" title="Writeup TryHackme Sighunt" href="/feed.xml">
</head>


    <span class="mobile btn-mobile-menu">
      <i class="icon icon-list btn-mobile-menu__icon"></i>
      <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

<header class="panel-cover" style="background-image: url(/images/cover.gif)">

  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
      <div class="panel-main__content">

          <img src="/images/profile.jpg" class="user-image zoomable" alt="Md Amiruddin">
          <h1 class="panel-cover__title panel-title scale-up-center">Md Amiruddin</h1>

        <hr class="panel-cover__divider">
        <p class="panel-cover__description slide-top">This Site Contains CTFs Writeup</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">
         <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item grow"><a href="/thm" title="Md Amiruddin" class="blog-button">TryHackme</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
              
             <li class="navigation__item grow">
                <a href="https://github.com/MdAmiruddin" title="Github" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>

              <li class="navigation__item grow">
                <a href="https://linkedin.com/in/mdamiruddin" title="Linkedin" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">Linkedin</span>
                </a>
              </li>
              
              <li class="navigation__item grow">
                <a href="https://mdamiruddin.medium.com" title="Medium" target="_blank">
                  <i class="icon icon-social-medium"></i>
                  <span class="label">Medium</span>
                </a>
              </li>
              
              <li class="navigation__item grow">
                <a href="mailto:sample@gmail.com" title="Emai" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>

            </ul>
          </nav>
        </div>
      </div>
    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>
    <br>
    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
    <div class="izquierda">
    
  </div>

  <header class="post-header slide-top">
   
    <head>
<style>
body {
  background-color: #000000;
  color: #FFFFFF;
  font-family: Calibri, Sans Serif;
}

.darkMode{
  background-color: #ffffff;
  color: #000000;
}

</style>
</head>
<body>
<button id="darkModeToggle">☀️ </button>


<script>
  const darkModeToggle = document.querySelector('#darkModeToggle');
  
  darkModeToggle.addEventListener('click', () => {
    document.body.classList.toggle('darkMode')
  })
  
</script>

</body>
    <br>
    <picture><img src="https://tryhackme-images.s3.amazonaws.com/room-icons/d4a19b63d083873e115f15b642c52981.png" style="float: right; margin-right:0px; margin-left:0px; height:60px;" class="include_image zoomable"/></picture>
   
  </header>


<br>
<br>          
<h1 id="tryhackme-sighunt-writeup-walkthrough">Tryhackme Sighunt Writeup/Walkthrough</h1>
<p>This room aims to be a supplementary room for Sigma rule creation. In this scenario, you will act as one of the Detection Engineers that will craft Sigma Rules based on the Indicators of Compromise (IOCs) collected by your Incident Responders.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:700/1*dHYklK-25Rh154YQanVHgA.png" alt=""></p>
<p>Room Link :  <a href="https://tryhackme.com/room/sighunt">https://tryhackme.com/room/sighunt</a></p>
<h1 id="-prerequisites-"><strong>Prerequisites</strong></h1>
<p>This <a href="https://tryhackme.com/room/sighunt">room</a>  requires basic knowledge of detection engineering and Sigma rule creation. I recommend going through the following rooms before attempting this challenge.</p>
<ul>
<li><a href="https://tryhackme.com/room/sigma">Sigma</a></li>
</ul>
<p><img src="https://miro.medium.com/v2/resize:fit:700/1*KQOhM4G87np1UxDEGD4k1Q.png" alt=""></p>
<h1 id="-sighunt-interface-"><strong>SigHunt Interface</strong></h1>
<p>Before we proceed, let’s deploy the attached machine in this task since it may take up to 3–5 minutes to initialize the services.</p>
<p>We will use this link to access the interface —  <a href="http://machine_ip/">http://MACHINE_IP</a></p>
<h1 id="-how-to-use-the-sighunt-interface-"><strong>How to use the SigHunt Interface:</strong></h1>
<ul>
<li><strong>Run</strong>  — Submit your Sigma rule and see if it detects the malicious IOC.</li>
<li><strong>Text Editor —</strong> Write your Sigma rule in this section.</li>
<li><strong>Create Rule</strong>  — Create a Sigma rule for the malicious IOC.</li>
<li><strong>View Log</strong>  — View the log details associated with the malicious IOC.</li>
</ul>
<p><img src="https://miro.medium.com/v2/resize:fit:700/0*TyEqf9jPmN01WlXR.png" alt=""></p>
<h1 id="-huntme-incident-"><strong>Huntme Incident</strong></h1>
<p><strong>Scenario</strong></p>
<p>You are hired as a Detection Engineer for your organization. During your first week, a ransomware incident has just concluded, and the Incident Responders of your organization have successfully mitigated the threat. With their collective effort, the Incident Response (IR) Team provided the IOCs based on their investigation. Your task is to create Sigma rules to improve the detection capabilities of your organization and prevent future incidents similar to this.</p>
<p><strong>Indicators of Compromise</strong></p>
<p>Based on the given incident report, the Incident Responders discovered the following attack chain:</p>
<ul>
<li>Execution of malicious HTA payload from a phishing link.</li>
<li>Execution of Certutil tool to download Netcat binary.</li>
<li>Netcat execution to establish a reverse shell.</li>
<li>Enumeration of privilege escalation vectors through PowerUp.ps1.</li>
<li>Abused service modification privileges to achieve System privileges.</li>
<li>Collected sensitive data by archiving via 7-zip.</li>
<li>Exfiltrated sensitive data through  <strong>cURL</strong> binary.</li>
<li>Executed ransomware with  <strong>huntme</strong>  as the file extension.</li>
</ul>
<p>In addition, the Incident Responders provided a table of IOCs at your disposal.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:700/1*4w5CGuedBzZzs3rT4ypJsQ.png" alt=""></p>
<h1 id="-rule-creation-standards-"><strong>Rule Creation Standards</strong></h1>
<p>The Detection Engineering Team follows a standard when creating a Sigma Rule. You may refer to the guidelines below.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:700/1*QA-qUZ-lY7o3J8sEH_j6vg.png" alt=""></p>
<h1 id="answer-the-questions-below-">Answer the questions below :</h1>
<h1 id="-what-is-the-challenge-1-flag-"><strong>What is the Challenge #1 flag?</strong></h1>
<p>First of all go the  <a href="https://www.uuidgenerator.net/">Online UUID generator</a>  and copy that code and paste it in the id section of  <strong>suspicious_mshta_execution.yml</strong></p>
<p><img src="https://miro.medium.com/v2/resize:fit:700/1*ZVoibIio9QWt8boMTt3PiQ.png" alt=""></p>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ code </span><span class="p">-->
title: sighunt
id: 232c5562-f775-4ad4-a162-816c99b013a6
status: rule testing 
description: HTA payload detection
author: lordofficial
date: 06/02/2023
modified: 06/02/23
logsource:
  product: windows
  service: process_creation
detection:
  selection:
    EventID: 1 
    ParentImage|endswith: '\chrome.exe'
    Image|endswith: '\mshta.exe'
  condition: selection
  </span>
</code></pre></div></div><br>
          

<p>After writing the sigma rule we can run the code  <strong>$suspicious_mshta_execution.yml</strong>  to get the flag.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:700/1*8VtbASa5y30n5GbxJE-KwQ.jpeg" alt=""></p>
<h1 id="-what-is-the-challenge-2-flag-"><strong>What is the Challenge #2 flag?</strong></h1>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">          
<code><span class="ve">❯ code </span><span class="p">-->
title: Sighunt
id: 232c5562-f775-4ad4-a162-816c99b013a6
status: rule testing 
description: certutil download
author: lordofficial
date: 06/02/2023
modified: 06/02/23
logsource:
  product: windows
  service: process_creation
detection:
  selection:
    EventID: 1 
 
    Image|endswith: '\certutil.exe'
    CommandLine|contains: 
     - ' -urlcache '
     - ' -split '
     - ' -f '
  condition: selection
  </span>
</code></pre></div></div><br>
                    
          
<pre><code>Image|endswith: '\certutil.exe'  
CommandLine|contains:   
 -<span class="ruby"> <span class="hljs-string">' -urlcache '</span>  
</span> -<span class="ruby"> <span class="hljs-string">' -split '</span>  
</span> -<span class="ruby"> <span class="hljs-string">' -f '</span>  </span>
</code></pre><p>  condition: selection</p>
<p>After writing the sigma rule we can run the code  <strong>$certutil_file_ingress.yml</strong>  to get the flag.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:700/1*KWoeEYyWlFRBgdh5829y8g.jpeg" alt=""></p>
<h1 id="-what-is-the-challenge-3-flag-"><strong>What is the Challenge #3 flag?</strong></h1>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">          
<code><span class="ve">❯ code </span><span class="p">-->
title: sighunt
id: 232c5562-f775-4ad4-a162-816c99b013a6
status: rule testing 
description: Netcat Execution
author: lordofficial
date: 06/02/2023
modified: 06/02/23
logsource:
  product: windows
  service: process_creation
detection:
  selection1:
    EventID: 1 
 
    Image|endswith: '\nc.exe'
    CommandLine|contains|all: 
     - ' -e '
  selection2:
    Hashes|contains: '523613A7B9DFA398CBD5EBD2DD0F4F38'
   
  condition: selection1 or selection2
  </span>
</code></pre></div></div><br>  
  
<pre><code>Image|<span class="hljs-string">endswith:</span> <span class="hljs-string">'\nc.exe'</span>  
CommandLine|contains|<span class="hljs-string">all:</span>   
 - <span class="hljs-string">' -e '</span>  
</code></pre><p>  selection2:<br>    Hashes|contains: &#39;523613A7B9DFA398CBD5EBD2DD0F4F38&#39;  </p>
<p>  condition: selection1 or selection2</p>
<p>After writing the sigma rule we can run the code  <strong>$netcat_reverse_shell.yml</strong>  to get the flag.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:700/1*aVp3OT0UwpFgmJwUjmrj6g.jpeg" alt=""></p>
<h1 id="-what-is-the-challenge-4-flag-"><strong>What is the Challenge #4 flag?</strong></h1>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">          
<code><span class="ve">❯ code </span><span class="p">-->
title: Sighunt
id: 232c5562-f775-4ad4-a162-816c99b013a6
status: rule testing 
description: PowerUp Enumeration
author: lordofficial
date: 06/02/2023
modified: 06/02/23
logsource:
  product: windows
  service: process_creation
detection:
  selection:
    EventID: 1 
 
    Image|endswith: '\powershell.exe'
    CommandLine|contains: 
     - 'Invoke-AllChecks'
     - 'PowerUp'
   
  condition: selection
  </span>
</code></pre></div></div><br>

<pre><code>Image|<span class="hljs-string">endswith:</span> <span class="hljs-string">'\powershell.exe'</span>  
CommandLine|<span class="hljs-string">contains:</span>   
 - <span class="hljs-string">'Invoke-AllChecks'</span>  
 - <span class="hljs-string">'PowerUp'</span>  
</code></pre><p>  condition: selection</p>
<p>After writing the sigma rule we can run the code  <strong>$powerup_enumeration.yml</strong>  to get the flag.</p>
<h1 id="what-is-the-challenge-5-flag-">What is the Challenge #5 flag?</h1>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">
<code><span class="ve">❯ code </span><span class="p">-->
title: Sighunt
id: 232c5562-f775-4ad4-a162-816c99b013a6
status: rule testing 
description: Service Binary
author: lordofficial
date: 06/02/2023
modified: 06/02/23
logsource:
  product: windows
  service: process_creation
detection:
  selection:
    EventID: 1 
 
    Image|endswith: '\sc.exe'
    CommandLine|contains|all: 
     - ' config '
     - ' binPath= '
     - ' -e '
   
  condition: selection
  </span>
</code></pre></div></div><br>

<pre><code>Image|endswith: '\sc.exe'  
CommandLine|contains|all:   
 -<span class="ruby"> <span class="hljs-string">' config '</span>  
</span> -<span class="ruby"> <span class="hljs-string">' binPath= '</span>  
</span> -<span class="ruby"> <span class="hljs-string">' -e '</span>  </span>
</code></pre><p>  condition: selection</p>
<p>After writing the sigma rule we can run the code  <strong>$service_binary_privesc.yml</strong>  to get the flag.</p>
<h1 id="what-is-the-challenge-6-flag-">What is the Challenge #6 flag?</h1>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">          
<code><span class="ve">❯ code </span><span class="p">-->
title: Sighunt
id: 232c5562-f775-4ad4-a162-816c99b013a6
status: rule testing 
description: RunOnce Persistence
author: lordofficial
date: 06/02/2023
modified: 06/02/23
logsource:
  product: windows
  service: process_creation
detection:
  selection:
    EventID: 1 
 
    Image|endswith: '\reg.exe'
    CommandLine|contains: 
     - ' add '
     - ' RunOnce '
  
   
  condition: selection
  </span>
</code></pre></div></div><br>

<pre><code>Image|<span class="hljs-string">endswith:</span> <span class="hljs-string">'\reg.exe'</span>  
CommandLine|<span class="hljs-string">contains:</span>   
 - <span class="hljs-string">' add '</span>  
 - <span class="hljs-string">' RunOnce '</span>  
</code></pre><p>  condition: selection</p>
<p>After writing the sigma rule we can run the code  <strong>$runonce_persistence.yml</strong>  to get the flag.</p>
<h1 id="what-is-the-challenge-7-flag-">What is the Challenge #7 flag?</h1>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">          
<code><span class="ve">❯ code </span><span class="p">-->
title: Sighunt
id: 232c5562-f775-4ad4-a162-816c99b013a6
status: rule testing 
description: 7z Archive
author: lordofficial
date: 06/02/2023
modified: 06/02/23
logsource:
  product: windows
  service: process_creation
detection:
  selection:
    EventID: 1 
 
    Image|endswith: '\7z.exe'
    CommandLine|contains: 
     - ' a '
     - ' -p '
  
   
  condition: selection
  </span>
</code></pre></div></div><br>

<pre><code>Image|<span class="hljs-string">endswith:</span> <span class="hljs-string">'\7z.exe'</span>  
CommandLine|<span class="hljs-string">contains:</span>   
 - <span class="hljs-string">' a '</span>  
 - <span class="hljs-string">' -p '</span>  
</code></pre><p>  condition: selection</p>
<p>After writing the sigma rule we can run the code  <strong>$7z_suspicious_archive.yml</strong>  to get the flag.</p>
<h1 id="what-is-the-challenge-8-flag-">What is the Challenge #8 flag?</h1>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">         
<code><span class="ve">❯ code </span><span class="p">-->
title: Sighunt
id: 232c5562-f775-4ad4-a162-816c99b013a6
status: rule testing 
description: Curl Data
author: lordofficial
date: 06/02/2023
modified: 06/02/23
logsource:
  product: windows
  service: process_creation
detection:
  selection:
    EventID: 1 
 
    Image|endswith: '\curl.exe'
    CommandLine|contains: 
     - ' -d '
 
  
   
  condition: selection
  </span>
</code></pre></div></div><br>

<pre><code>Image|<span class="hljs-string">endswith:</span> <span class="hljs-string">'\curl.exe'</span>  
CommandLine|<span class="hljs-string">contains:</span>   
 - <span class="hljs-string">' -d '</span>  
</code></pre><p>  condition: selection</p>
<p>After writing the sigma rule we can run the code  <strong>$ curl_exfiltration.yml</strong>  to get the flag.</p>
<h1 id="what-is-the-challenge-9-flag-">What is the Challenge #9 flag?</h1>

<div class="language-python highlighter-rouge contenedor"><div class="highlight"><pre class="highlight">          
<code><span class="ve">❯ code </span><span class="p">-->
title: Sighunt
id: 232c5562-f775-4ad4-a162-816c99b013a6
status: rule testing 
description: Ransomware File
author: lordofficial
date: 06/02/2023
modified: 06/02/23
logsource:
  product: windows
  service: process_creation
detection:
  selection:
    EventID: 11
    TargetFilename:  '*.huntme'
   
  condition: selection
  </span>
</code></pre></div></div><br>

<p>  condition: selection</p>
<p>After writing the sigma rule we can run the code  <strong>$ransomware_file_encryption.yml</strong> to get the flag.</p>
<h1 id="thanks-for-reading-">Thanks For Reading.</h1>



</article>
  </div>
  <footer class="footer">
    <span class="footer__copyright">&copy; 2023 - Md Amiruddin</span>
  </footer><br><br>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js?1678894953382991917"></script>

    </div>
  </body>
</html>
